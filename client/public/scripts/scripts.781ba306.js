"use strict";angular.module("ngLocale",[],["$provide",function(a){var b={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};a.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["domingo","segunda-feira","terça-feira","quarta-feira","quinta-feira","sexta-feira","sábado"],ERANAMES:["antes de Cristo","depois de Cristo"],ERAS:["a.C.","d.C."],FIRSTDAYOFWEEK:6,MONTH:["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],SHORTDAY:["dom","seg","ter","qua","qui","sex","sáb"],SHORTMONTH:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],STANDALONEMONTH:["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],WEEKENDRANGE:[5,6],fullDate:"EEEE, d 'de' MMMM 'de' y",longDate:"d 'de' MMMM 'de' y",medium:"d 'de' MMM 'de' y HH:mm:ss",mediumDate:"d 'de' MMM 'de' y",mediumTime:"HH:mm:ss",short:"dd/MM/yy HH:mm",shortDate:"dd/MM/yy",shortTime:"HH:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"R$",DECIMAL_SEP:",",GROUP_SEP:".",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-¤",negSuf:"",posPre:"¤",posSuf:""}]},id:"pt-br",localeID:"pt_BR",pluralCat:function(a,c){return a>=0&&a<=2&&2!=a?b.ONE:b.OTHER}})}]),angular.module("finansesApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","angularFileUpload","ui.bootstrap"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/importadores",{templateUrl:"views/importers.html",controller:"ImportersCtrl",controllerAs:"importers"}).otherwise({redirectTo:"/"})}]).filter("money",function(){return function(a,b,c,d){var e=String(a);if(c){var f=e.split(""),g=f.splice(f.length-c);f=f.concat([d]),f=f.concat(g),e=f.join("")}return e=b?b+e:"$"+e}}).directive("rvgModal",function(){return{restrict:"E",replace:!0,templateUrl:function(a,b){return"/"+b.templateUrl},scope:{control:"="},link:function(a,b,c){a.internalControl=a.control||{},a.opened=!1,a.internalControl.open=function(){a.opened=!0},a.internalControl.close=function(){a.opened=!1,a.$emit("modalClose")}}}}),angular.module("finansesApp").controller("MainCtrl",["$scope","$http",function(a,b){a.modalControl={};var c={Authorization:"Token token=secret",Accept:"application/json;odata=verbose"};a.getTransactions=function(){b({method:"GET",url:"/api/transactions",headers:c}).then(function(b){var c=b.data;c.forEach(function(a){var b=a.date,c=/(\d\d\d\d)-(\d\d)-(\d\d)/,d=c.exec(b);d&&(a.date=d[3]+"/"+d[2]+"/"+d[1])}),a.transactions=b.data},function(a){console.log(a)})},a.$on("modalClose",function(){a.getTransactions()}),a.destroyTransaction=function(d){b({method:"DELETE",url:"/api/transactions/"+d,headers:c}).then(function(b){a.getTransactions()},function(a){console.log(a),alert("asdasd")})},a.editTransaction=function(b){a.modalControl.formData={description:b.description,value:b.value,date:b.date,id:b.id},a.modalControl.open()},a.addTransaction=function(){a.modalControl.open()},a.modalControl.addTransaction=function(){var d;console.log(a.modalControl.formData),d=a.modalControl.formData.id>0?"/api/transactions/edit/"+a.modalControl.formData.id:"/api/transactions/create",b({method:"POST",url:d,headers:c,data:{transaction:a.modalControl.formData}}).then(function(b){a.modalControl.formData={},a.modalControl.close()},function(a){console.log(a)})},a.getTransactions()}]),angular.module("finansesApp").controller("ImportersCtrl",["$scope","$http","FileUploader",function(a,b,c){var d=a.uploader=new c({url:"/api/upload"}),e={Authorization:"Token token=secret",Accept:"application/json;odata=verbose"};a.importItem=function(c,d){b({method:"POST",url:"/api/transactions/create",headers:e,data:{transaction:c}}).then(function(b){a.importedTransactions.splice(d,1)},function(a){console.log(a)})},a.removeItem=function(b){a.importedTransactions.splice(b,1)},d.onBeforeUploadItem=function(a){a.headers=e},d.onCompleteItem=function(b,c,d,e){a.importedTransactions=c}}]),angular.module("finansesApp").run(["$templateCache",function(a){a.put("views/importers.html",'<input type="file" nv-file-select="" uploader="uploader"> <div class="col-md-9" style="margin-bottom: 40px"> <h3>Upload queue</h3> <p>Queue length: {{ uploader.queue.length }}</p> <table class="table"> <thead> <tr> <th width="50%">Name</th> <th ng-show="uploader.isHTML5">Size</th> <th ng-show="uploader.isHTML5">Progress</th> <th>Status</th> <th>Actions</th> </tr> </thead> <tbody> <tr ng-repeat="item in uploader.queue"> <td><strong>{{ item.file.name }}</strong></td> <td ng-show="uploader.isHTML5" nowrap>{{ item.file.size/1024/1024|number:2 }} MB</td> <td ng-show="uploader.isHTML5"> <div class="progress" style="margin-bottom: 0"> <div class="progress-bar" role="progressbar" ng-style="{ \'width\': item.progress + \'%\' }"></div> </div> </td> <td class="text-center"> <span ng-show="item.isSuccess"><i class="glyphicon glyphicon-ok"></i></span> <span ng-show="item.isCancel"><i class="glyphicon glyphicon-ban-circle"></i></span> <span ng-show="item.isError"><i class="glyphicon glyphicon-remove"></i></span> </td> <td nowrap> <button type="button" class="btn btn-success btn-xs" ng-click="item.upload()" ng-disabled="item.isReady || item.isUploading || item.isSuccess"> <span class="glyphicon glyphicon-upload"></span> Upload </button> <button type="button" class="btn btn-warning btn-xs" ng-click="item.cancel()" ng-disabled="!item.isUploading"> <span class="glyphicon glyphicon-ban-circle"></span> Cancel </button> <button type="button" class="btn btn-danger btn-xs" ng-click="item.remove()"> <span class="glyphicon glyphicon-trash"></span> Remove </button> </td> </tr> </tbody> </table> <div> <div> Queue progress: <div class="progress" style=""> <div class="progress-bar" role="progressbar" ng-style="{ \'width\': uploader.progress + \'%\' }"></div> </div> </div> <button type="button" class="btn btn-success btn-s" ng-click="uploader.uploadAll()" ng-disabled="!uploader.getNotUploadedItems().length"> <span class="glyphicon glyphicon-upload"></span> Upload all </button> <button type="button" class="btn btn-warning btn-s" ng-click="uploader.cancelAll()" ng-disabled="!uploader.isUploading"> <span class="glyphicon glyphicon-ban-circle"></span> Cancel all </button> <button type="button" class="btn btn-danger btn-s" ng-click="uploader.clearQueue()" ng-disabled="!uploader.queue.length"> <span class="glyphicon glyphicon-trash"></span> Remove all </button> </div> <div class="imported-list"> <div class="item" ng-repeat="transaction in importedTransactions track by $index"> <div class="row"> <div class="col-xs-10"> <div> {{ transaction.description }} {{ transaction.value }} </div> <div> {{ transaction.date }} </div> </div> <div class="col-xs-2"> <a class="btn" ng-click="importItem(transaction, $index)"><i class="fa fa-check"></i></a> <a class="btn" ng-click="removeItem($index)"><i class="fa fa-close"></i></a> </div> </div> </div> </div> </div>'),a.put("views/main.html",'<div class="transaction-list"> <div class="item" ng-repeat="transaction in transactions track by transaction.id"> <div class="row"> <div class="col-xs-8"> <div> {{ transaction.description }} </div> <div> {{ transaction.date }} </div> </div> <div class="col-xs-2"> {{ transaction.value | money:"R$ ":"2":"," }} </div> <div class="col-xs-2"> <a class="btn icon" ng-click="editTransaction(transaction)"><i class="fa fa-pencil"></i></a> <a class="btn icon" ng-click="destroyTransaction(transaction.id)"><i class="fa fa-trash"></i></a> </div> </div> </div> </div> <a class="btn btn-primary" ng-click="addTransaction()">Adicionar</a> <rvg-modal control="modalControl" template-url="modalTemplate.html"></rvg-modal>'),a.put("views/modalTemplate.html",'<div ng-show="opened" class="modal fade in" role="dialog" id="myModal" tabindex="-1" aria-labelledby="myModalLabel" style="display: block"> <div class="modal-dialog" role="document"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" ng-click="internalControl.close()"> <span aria-hidden="true">×</span> </button> <h4 class="modal-title" id="myModalLabel">Transaction details</h4> </div> <div class="modal-body"> <form ng-submit="internalControl.addTransaction()"> <div class="form-group"> <input type="text" placeholder="Descrição" ng-model="internalControl.formData.description"> </div> <div class="form-group"> <input type="text" placeholder="Valor" ng-model="internalControl.formData.value"> </div> <div class="form-group"> <input type="text" placeholder="Data" ng-model="internalControl.formData.date"> </div> <input type="submit" value="Adicionar transação" class="btn btn-primary"> </form> </div> </div> </div> </div>')}]);