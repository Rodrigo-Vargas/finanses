"use strict";angular.module("ngLocale",[],["$provide",function(a){var b={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};a.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["domingo","segunda-feira","terça-feira","quarta-feira","quinta-feira","sexta-feira","sábado"],ERANAMES:["antes de Cristo","depois de Cristo"],ERAS:["a.C.","d.C."],FIRSTDAYOFWEEK:6,MONTH:["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],SHORTDAY:["dom","seg","ter","qua","qui","sex","sáb"],SHORTMONTH:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],STANDALONEMONTH:["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],WEEKENDRANGE:[5,6],fullDate:"EEEE, d 'de' MMMM 'de' y",longDate:"d 'de' MMMM 'de' y",medium:"d 'de' MMM 'de' y HH:mm:ss",mediumDate:"d 'de' MMM 'de' y",mediumTime:"HH:mm:ss",short:"dd/MM/yy HH:mm",shortDate:"dd/MM/yy",shortTime:"HH:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"R$",DECIMAL_SEP:",",GROUP_SEP:".",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-¤",negSuf:"",posPre:"¤",posSuf:""}]},id:"pt-br",localeID:"pt_BR",pluralCat:function(a,c){return a>=0&&a<=2&&2!=a?b.ONE:b.OTHER}})}]),angular.module("finansesApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","angularFileUpload","ui.bootstrap"]).config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/importadores",{templateUrl:"views/importers.html",controller:"ImportersCtrl",controllerAs:"importers"}).when("/categorias",{templateUrl:"views/categories.html",controller:"CategoriesCtrl",controllerAs:"categories"}).when("/signup",{templateUrl:"views/signup.html",controller:"SignupCtrl",controllerAs:"signup"}).when("/login",{templateUrl:"views/login.html",controller:"LoginCtrl",controllerAs:"login"}).when("/logout",{templateUrl:"views/logout.html",controller:"LogoutCtrl",controllerAs:"logout"}).otherwise({redirectTo:"/"}),b.html5Mode(!0)}]).filter("money",function(){return function(a,b,c,d){var e=String(a);if(c){var f=e.split(""),g=f.splice(f.length-c);f=f.concat([d]),f=f.concat(g),e=f.join("")}return e=b?b+e:"$"+e}}).factory("UserInfoService",["$cookies",function(a){var b;return{get:function(){return b||a.get("userInfo")&&(b=JSON.parse(a.get("userInfo"))),b},set:function(c){b=c;var d=new Date;d.setMinutes(d.getMinutes()+60),a.put("userInfo",JSON.stringify(b),{expires:d})},clear:function(){console.log("Clear!"),b=null,a.remove("userInfo")}}}]).directive("rvgModal",function(){return{restrict:"E",replace:!0,templateUrl:function(a,b){return"/"+b.templateUrl},scope:{control:"="},link:function(a,b,c){a.internalControl=a.control||{},a.opened=!1,a.internalControl.open=function(){a.opened=!0},a.internalControl.close=function(){a.opened=!1,a.$emit("modalClose")}}}}),angular.module("finansesApp").controller("MainCtrl",["$scope","$http","$location","UserInfoService",function(a,b,c,d){var e=d.get();if(!e)return void c.path("/login");a.months=[{id:1,name:"Janeiro"},{id:2,name:"Fevereiro"},{id:3,name:"Março"},{id:4,name:"Abril"},{id:5,name:"Maio"},{id:6,name:"Junho"},{id:7,name:"Julho"},{id:8,name:"Agosto"},{id:9,name:"Setembro"},{id:10,name:"Outubro"},{id:11,name:"Novembro"},{id:12,name:"Dezembro"}],a.years=[2011,2012,2013,2014,2015,2016],a.modalControl={},a.transactions=[],a.selectedMonth={id:(new Date).getMonth()+1},a.selectedYear=(new Date).getFullYear();var f={Authorization:"Token token="+e.token,Accept:"application/json;odata=verbose"};a.getCategories=function(){b({method:"GET",url:"/api/categories",headers:f}).then(function(b){a.modalControl.categories=b.data.categories},function(a){console.log(a)})},a.getTransactions=function(){b({method:"GET",url:"/api/transactions/period/"+a.selectedMonth.id+"/"+a.selectedYear,headers:f}).then(function(b){a.transactions=b.data.transactions},function(a){console.log(a)})},a.monthChange=function(){a.getTransactions()},a.yearChange=function(){a.getTransactions()},a.destroyTransaction=function(c){b({method:"DELETE",url:"/api/transactions/"+c,headers:f}).then(function(b){a.getTransactions()},function(a){console.log(a)})},a.editTransaction=function(b){a.modalControl.formData={description:b.description,value:b.value,date:b.date,id:b.id},a.modalControl.open()},a.addTransaction=function(){a.modalControl.open()},a.modalControl.addTransaction=function(){var c;c=a.modalControl.formData.id>0?"/api/transactions/edit/"+a.modalControl.formData.id:"/api/transactions",b({method:"POST",url:c,headers:f,data:{transaction:a.modalControl.formData}}).then(function(b){a.modalControl.formData={},a.modalControl.close(),a.getTransactions()},function(a){console.log(a)})},a.getCategories(),a.getTransactions()}]),angular.module("finansesApp").controller("ImportersCtrl",["$scope","$http","$location","UserInfoService","FileUploader",function(a,b,c,d,e){var f=d.get();if(!f)return void c.path("/login");var g=a.uploader=new e({url:"/api/upload"}),h={Authorization:"Token token="+f.token,Accept:"application/json;odata=verbose"};a.importItem=function(c,d){b({method:"POST",url:"/api/transactions",headers:h,data:{transaction:c.original}}).then(function(b){a.importedTransactions.splice(d,1)},function(a){console.log(a)})},a.removeItem=function(b){a.importedTransactions.splice(b,1)},g.onAfterAddingFile=function(a){a.upload()},g.onBeforeUploadItem=function(a){a.headers=h},g.onCompleteItem=function(b,c,d,e){a.importedTransactions=c}}]),angular.module("finansesApp").controller("SignupCtrl",["$scope","$http","$location","UserInfoService",function(a,b,c,d){a.submit=function(){b({method:"POST",url:"/api/users",data:a.formData}).then(function(a){d.set({token:a.data.token}),c.path("/transactions")},function(a){console.log(a)})}}]),angular.module("finansesApp").controller("LogoutCtrl",["$location","UserInfoService",function(a,b){b.clear(),a.path("/login")}]),angular.module("finansesApp").controller("LoginCtrl",["$scope","$http","$location","UserInfoService",function(a,b,c,d){var e=d.get();return e?void c.path("/"):void(a.submit=function(){b({method:"POST",url:"/api/users/login",data:{user:a.formData}}).then(function(a){a.data.success?(d.set({token:a.data.token}),c.path("/")):alert("Credenciais incorretas")})})}]),angular.module("finansesApp").controller("CategoriesCtrl",["$scope","$http","$location","UserInfoService",function(a,b,c,d){var e=d.get();if(!e)return void c.path("/login");a.modalControl={};var f={Authorization:"Token token="+e.token,Accept:"application/json;odata=verbose"};a.addCategory=function(){a.modalControl.open()},a.getCategories=function(){b({method:"GET",url:"/api/categories",headers:f}).then(function(b){a.categories=b.data.categories},function(a){console.log(a)})},a.editCategory=function(b){a.modalControl.formData={name:b.name,id:b.id},a.modalControl.open()},a.destroyCategory=function(c){b({method:"DELETE",url:"/api/categories/"+c,headers:f}).then(function(b){a.getCategories()},function(a){console.log(a)})},a.modalControl.addCategory=function(){var c,d;a.modalControl.formData.id>0?(c="/api/categories/"+a.modalControl.formData.id,d="PATCH"):(c="/api/categories",d="POST"),b({method:d,url:c,headers:f,data:{category:a.modalControl.formData}}).then(function(b){a.modalControl.formData={},a.modalControl.close(),a.getCategories()},function(a){console.log(a)})},a.getCategories()}]),angular.module("finansesApp").run(["$templateCache",function(a){a.put("views/categories.html",'<div class="commands-wrapper"> <a class="btn btn-primary" ng-click="addCategory()">Adicionar</a> </div> <div class="categories-list"> <div class="item" ng-repeat="category in categories track by category.id"> <div class="row"> <div class="col-xs-10"> <span>{{ category.name }}</span> </div> <div class="col-xs-2"> <a class="btn icon" ng-click="editCategory(category)"><i class="fa fa-pencil"></i></a> <a class="btn icon" ng-click="destroyCategory(category.id)"><i class="fa fa-trash"></i></a> </div> </div> </div> </div> <rvg-modal control="modalControl" template-url="addCategoryTemplate.html"></rvg-modal>'),a.put("views/importers.html",'<input type="file" nv-file-select="" uploader="uploader"> <div class="col-md-9" style="margin-bottom: 40px"> <div> <div> Upload progress: <div class="progress" style=""> <div class="progress-bar" role="progressbar" ng-style="{ \'width\': uploader.progress + \'%\' }"></div> </div> </div> </div> <div class="imported-list"> <div class="item" ng-repeat="transaction in importedTransactions track by $index"> <div class="row"> <div class="col-xs-5"> <div> {{ transaction.original.description }} {{ transaction.original.value }} </div> <div> {{ transaction.original.date }} </div> </div> <div class="col-xs-2"> <a class="btn" title="Importar" ng-click="importItem(transaction, $index)"><i class="fa fa-check"></i></a> <a class="btn" title="Dispensar" ng-click="removeItem($index)"><i class="fa fa-close"></i></a> </div> <div class="col-xs-5"> <div ng-hide="transaction.found"> <span>Registro não encontrado no servidor</span> </div> <div ng-show="transaction.found"> <div> {{ transaction.found.description }} {{ transaction.found.value }} </div> <div> {{ transaction.found.date }} </div> </div> </div> </div> </div> </div> </div>'),a.put("views/login.html",'<style>.side-nav {\n    display: none;\n  }</style> <input type="text" class="form-control" placeholder="Email" ng-model="formData.email"> <input type="password" class="form-control" placeholder="Senha" ng-model="formData.password"> <button class="btn btn-primary" ng-click="submit()">Entrar</button> <a href="/signup">Cadastrar</a>'),a.put("views/logout.html","<p>This is the logout view.</p>"),a.put("views/main.html",'<div class="row"> <div class="col-xs-2"> <div class="commands-wrapper"> <a class="btn btn-primary" ng-click="addTransaction()">Adicionar</a> </div> </div> <div class="col-xs-4"> <select class="form-control" ng-model="selectedMonth" ng-options="month as month.name for month in months track by month.id" ng-change="monthChange()"></select> </div> <div class="col-xs-4"> <select class="form-control" ng-model="selectedYear" ng-options="year as year for year in years track by year" ng-change="yearChange()"></select> </div> </div> <div class="transaction-list" ng-show="transactions.length > 0"> <div class="item" ng-repeat="transaction in transactions track by transaction.id"> <div class="row"> <div class="col-xs-6"> <div> {{ transaction.description }} </div> <div> {{ transaction.date }} </div> </div> <div class="col-xs-2"> {{ transaction.category.name }} </div> <div class="col-xs-2"> {{ transaction.value | money:"R$ ":"2":"," }} </div> <div class="col-xs-2"> <a class="btn icon" ng-click="editTransaction(transaction)"><i class="fa fa-pencil"></i></a> <a class="btn icon" ng-click="destroyTransaction(transaction.id)"><i class="fa fa-trash"></i></a> </div> </div> </div> </div> <div ng-show="transactions.length == 0"> <span>Sem lançamentos no período.</span> </div> <rvg-modal control="modalControl" template-url="modalTemplate.html"></rvg-modal>'),a.put("views/signup.html",'<div class="form-group"> <input type="text" class="form-control" placeholder="Email" ng-model="formData.email"> <input type="password" class="form-control" placeholder="Senha" ng-model="formData.password"> <a class="btn btn-primary" ng-click="submit()">Cadastrar</a> </div>')}]);